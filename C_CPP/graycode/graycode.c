//todo this is the challenge of hctf2016 
//get the code of "gray code"
#include <stdio.h>
/*flag = hctf{0n_ThE_Se1f_ACc0m
* len(flag) = 22
* Easy_Game ----> function
* binary ---> the binary of Easy_Game
* len(binary) = 583
*/


int Easy_Game(unsigned char *);
const unsigned char binary[] = 
"\x55\x48\x89\xE5\x48\x89\x7D\xB8\xC7\x45\xFC\x0A\x00\x00\x00\xC7"
"\x45\xEC\x00\x00\x00\x00\xC7\x45\xE8\x00\x00\x00\x00\x48\xB8\xE0"
"\xA1\x90\x21\xC7\x50\x42\x00\x48\x89\x45\xE0\x48\xB8\x42\xA1\x23"
"\x63\x25\xE0\x95\x00\x48\x89\x45\xD0\x48\xB8\x3F\xED\x7C\x4C\x4F"
"\x68\xDF\x00\x48\x89\x45\xC0\xC7\x45\xF0\x00\x00\x00\x00\xE9\xE5"
"\x00\x00\x00\x8B\x45\xF0\x48\x63\xD0\x48\x8B\x45\xB8\x48\x01\xD0"
"\x0F\xB6\x00\x0F\xB6\xC0\x89\x45\xFC\xC7\x45\xF4\x00\x00\x00\x00"
"\xE9\xB5\x00\x00\x00\x8B\x45\xF0\x48\x63\xD0\x48\x8B\x45\xB8\x48"
"\x01\xD0\x8B\x55\xF0\x48\x63\xCA\x48\x8B\x55\xB8\x48\x01\xCA\x0F"
"\xB6\x12\xC1\xE2\x04\x88\x10\xC7\x45\xE8\x00\x00\x00\x00\xC7\x45"
"\xEC\x00\x00\x00\x00\xC7\x45\xF8\x08\x00\x00\x00\xEB\x4A\xD1\x65"
"\xE8\x83\x7D\xEC\x00\x75\x20\x8B\x45\xFC\x23\x45\xF8\x85\xC0\x74"
"\x0D\xC7\x45\xEC\x01\x00\x00\x00\x83\x4D\xE8\x01\xEB\x27\xC7\x45"
"\xEC\x00\x00\x00\x00\xEB\x1E\x8B\x45\xFC\x23\x45\xF8\x85\xC0\x74"
"\x09\xC7\x45\xEC\x01\x00\x00\x00\xEB\x0B\xC7\x45\xEC\x00\x00\x00"
"\x00\x83\x4D\xE8\x01\xD1\x7D\xF8\x83\x7D\xF8\x00\x7F\xB0\x8B\x45"
"\xF0\x48\x63\xD0\x48\x8B\x45\xB8\x48\x01\xD0\x8B\x55\xF0\x48\x63"
"\xCA\x48\x8B\x55\xB8\x48\x01\xCA\x0F\xB6\x12\x8B\x4D\xE8\x01\xCA"
"\x88\x10\xC1\x7D\xFC\x04\x83\x45\xF4\x01\x83\x7D\xF4\x01\x0F\x8E"
"\x41\xFF\xFF\xFF\x83\x45\xF0\x01\x83\x7D\xF0\x15\x0F\x8E\x11\xFF"
"\xFF\xFF\xC7\x45\xF8\x00\x00\x00\x00\x8B\x45\xF8\x48\x63\xD0\x48"
"\x8B\x45\xB8\x48\x01\xD0\x0F\xB6\x00\x3C\xC5\x74\x0A\xB8\x00\x00"
"\x00\x00\xE9\xDE\x00\x00\x00\xC7\x45\xF8\x01\x00\x00\x00\xEB\x38"
"\x8B\x45\xF8\x48\x63\xD0\x48\x8B\x45\xB8\x48\x01\xD0\x0F\xB6\x10"
"\x48\x8B\x45\xB8\x0F\xB6\x00\x31\xC2\x8B\x45\xF8\x83\xE8\x01\x48"
"\x98\x0F\xB6\x44\x05\xE0\x38\xC2\x74\x0A\xB8\x00\x00\x00\x00\xE9"
"\xA1\x00\x00\x00\x83\x45\xF8\x01\x83\x7D\xF8\x07\x7E\xC2\xC7\x45"
"\xF8\x08\x00\x00\x00\xEB\x43\x8B\x45\xF8\x48\x63\xD0\x48\x8B\x45"
"\xB8\x48\x01\xD0\x0F\xB6\x08\x8B\x45\xF8\x48\x98\x48\x8D\x50\xF9"
"\x48\x8B\x45\xB8\x48\x01\xD0\x0F\xB6\x00\x31\xC1\x89\xCA\x8B\x45"
"\xF8\x83\xE8\x08\x48\x98\x0F\xB6\x44\x05\xD0\x38\xC2\x74\x07\xB8"
"\x00\x00\x00\x00\xEB\x4F\x83\x45\xF8\x01\x83\x7D\xF8\x0E\x7E\xB7"
"\xC7\x45\xF8\x0F\x00\x00\x00\xEB\x31\x8B\x45\xF8\x48\x63\xD0\x48"
"\x8B\x45\xB8\x48\x01\xD0\x0F\xB6\x00\x83\xF0\x6A\x89\xC2\x8B\x45"
"\xF8\x83\xE8\x0F\x48\x98\x0F\xB6\x44\x05\xC0\x38\xC2\x74\x07\xB8"
"\x00\x00\x00\x00\xEB\x0F\x83\x45\xF8\x01\x83\x7D\xF8\x15\x7E\xC9"
"\xB8\x01\x00\x00\x00\x5D\xC3";
int main()
{
    char input[100] = {0}; 
    int (*Check )(unsigned char*);
    Check = (int(*)(unsigned char *))binary;
    int result = 0;
    
    scanf("%s",input);
    printf("Start && input: %s \n",input);
    result = Check(input);

    if(result == 0)
    {
        printf("NO\n");
    }
    else if(result == 1)
    {
        printf("OK\n");
    }
    else
    {
        printf("error!!!\n");
    }
    printf("===end===");
    return 0; 
}
int Easy_Game(unsigned char * input)
{
    int tok = 0xA;
    int i,j,k;
    int lastT = 0;
    int tmp = 0;

    unsigned char cmp1[] = "\xE0\xA1\x90\x21\xC7\x50\x42";
    unsigned char cmp2[] = "\x42\xA1\x23\x63\x25\xE0\x95";
    unsigned char cmp3[] = "\x3F\xED\x7C\x4C\x4F\x68\xDF";


    for(k = 0; k < 22; k ++)
    {
        
        for(tok = input[k],j = 0; j < 2; tok = (tok >> 4), j ++)
        {
            input[k] = input[k] << 4;
            tmp = 0;
            lastT = 0;
            for(i = 8 ; i >= 1 ; i= i >> 1 )
            {
                tmp = tmp <<1;
                if(lastT == 0)
                {
                    if(tok & i)
                    {
                        lastT = 1;
                        tmp = tmp | 1;
                    }
                    else
                    {
                        lastT = 0;
                    }
                }
                else
                {
                    if(tok & i)
                    {
                        lastT = 1;
                    }
                    else
                    {
                        lastT = 0;
                        tmp = tmp | 1;
                    }
                }
            }
            input[k] += tmp;


           
        }
    
    }

    i = 0;
    if((input[i] ^ 106) != 0xAF)
    {
        return 0;
    }
    for(i = 1; i < 8; i ++)
    {
        if(( input[i] ^ input[0]) != cmp1[i-1])
        {
            return 0;
        }
    }
    for(i = 8; i < 15; i++)
    {
        if(( input[i] ^ input[i-7]) != cmp2[i- 8])
        {
       
            return 0;
        }
    }
    for(i = 15; i < 22; i ++)
    {
        
        if(( input[i] ^ 106 ) != cmp3[i- 15])
        {
       
            return 0;
        }
    }
    return 1;
}
