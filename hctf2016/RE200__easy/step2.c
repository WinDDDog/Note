#include <stdio.h>
int Check_The_(char * input, char * step3, char * self);
char step2[] =
"\x55\x48\x89\xE5\x48\x81\xEC\x70\x01\x00\x00\x48\x89\xBD\xA8\xFE"
"\xFF\xFF\x48\x89\xB5\xA0\xFE\xFF\xFF\x48\x89\x95\x98\xFE\xFF\xFF"
"\xC7\x45\xF0\x04\x00\x00\x00\xC7\x45\xEC\x08\x00\x00\x00\x48\xB8"
"\x5D\x09\x90\x90\x26\x2F\x01\x8A\x48\x89\x45\xC0\xC6\x45\xC8\x00"
"\x48\x8B\x85\xA8\xFE\xFF\xFF\x0F\xB6\x00\x88\x45\xD0\x48\x8B\x85"
"\xA8\xFE\xFF\xFF\x48\x83\xC0\x01\x0F\xB6\x00\x88\x45\xD1\x48\x8B"
"\x85\xA8\xFE\xFF\xFF\x48\x83\xC0\x02\x0F\xB6\x00\x88\x45\xD2\x48"
"\x8B\x85\xA8\xFE\xFF\xFF\x48\x83\xC0\x03\x0F\xB6\x00\x88\x45\xD3"
"\x48\x83\x85\xA8\xFE\xFF\xFF\x05\xC7\x45\xFC\x00\x00\x00\x00\xEB"
"\x50\x8B\x45\xFC\x8D\x0C\x00\x8B\x45\xFC\x48\x63\xD0\x48\x8B\x85"
"\xA8\xFE\xFF\xFF\x48\x01\xD0\x0F\xB6\x00\x83\xE0\x0F\x89\xC2\x48"
"\x63\xC1\x88\x54\x05\xB0\x8B\x45\xFC\x01\xC0\x8D\x48\x01\x8B\x45"
"\xFC\x48\x63\xD0\x48\x8B\x85\xA8\xFE\xFF\xFF\x48\x01\xD0\x0F\xB6"
"\x00\xC0\xF8\x04\x89\xC2\x48\x63\xC1\x88\x54\x05\xB0\x83\x45\xFC"
"\x01\x83\x7D\xFC\x03\x7E\xAA\xC7\x45\xFC\x00\x00\x00\x00\xEB\x15"
"\x8B\x45\xFC\x89\xC2\x8B\x45\xFC\x48\x98\x88\x94\x05\xB0\xFE\xFF"
"\xFF\x83\x45\xFC\x01\x81\x7D\xFC\xFF\x00\x00\x00\x7E\xE2\xC7\x45"
"\xF8\x00\x00\x00\x00\xC7\x45\xFC\x00\x00\x00\x00\xE9\x86\x00\x00"
"\x00\x8B\x45\xFC\x48\x98\x0F\xB6\x84\x05\xB0\xFE\xFF\xFF\x0F\xB6"
"\xD0\x8B\x45\xF8\x8D\x0C\x02\x8B\x45\xFC\x99\xF7\x7D\xF0\x89\xD0"
"\x48\x98\x48\x8D\x55\xD0\x48\x01\xD0\x0F\xB6\x00\x0F\xB6\xC0\x8D"
"\x14\x01\x89\xD0\xC1\xF8\x1F\xC1\xE8\x18\x01\xC2\x0F\xB6\xD2\x29"
"\xC2\x89\xD0\x89\x45\xF8\x8B\x45\xFC\x48\x98\x0F\xB6\x84\x05\xB0"
"\xFE\xFF\xFF\x0F\xB6\xC0\x89\x45\xE8\x8B\x45\xF8\x48\x98\x0F\xB6"
"\x94\x05\xB0\xFE\xFF\xFF\x8B\x45\xFC\x48\x98\x88\x94\x05\xB0\xFE"
"\xFF\xFF\x8B\x45\xE8\x89\xC2\x8B\x45\xF8\x48\x98\x88\x94\x05\xB0"
"\xFE\xFF\xFF\x83\x45\xFC\x01\x81\x7D\xFC\xFF\x00\x00\x00\x0F\x8E"
"\x6D\xFF\xFF\xFF\xC7\x45\xFC\x00\x00\x00\x00\xC7\x45\xF8\x00\x00"
"\x00\x00\xC7\x45\xF4\x00\x00\x00\x00\xE9\xD8\x00\x00\x00\x8B\x45"
"\xFC\x8D\x50\x01\x89\xD0\xC1\xF8\x1F\xC1\xE8\x18\x01\xC2\x0F\xB6"
"\xD2\x29\xC2\x89\xD0\x89\x45\xFC\x8B\x45\xFC\x48\x98\x0F\xB6\x84"
"\x05\xB0\xFE\xFF\xFF\x0F\xB6\xD0\x8B\x45\xF8\x01\xC2\x89\xD0\xC1"
"\xF8\x1F\xC1\xE8\x18\x01\xC2\x0F\xB6\xD2\x29\xC2\x89\xD0\x89\x45"
"\xF8\x8B\x45\xFC\x48\x98\x0F\xB6\x84\x05\xB0\xFE\xFF\xFF\x0F\xB6"
"\xC0\x89\x45\xE8\x8B\x45\xF8\x48\x98\x0F\xB6\x94\x05\xB0\xFE\xFF"
"\xFF\x8B\x45\xFC\x48\x98\x88\x94\x05\xB0\xFE\xFF\xFF\x8B\x45\xE8"
"\x89\xC2\x8B\x45\xF8\x48\x98\x88\x94\x05\xB0\xFE\xFF\xFF\x8B\x45"
"\xFC\x48\x98\x0F\xB6\x94\x05\xB0\xFE\xFF\xFF\x8B\x45\xF8\x48\x98"
"\x0F\xB6\x84\x05\xB0\xFE\xFF\xFF\x01\xD0\x0F\xB6\xC0\x48\x98\x0F"
"\xB6\x84\x05\xB0\xFE\xFF\xFF\x0F\xB6\xC0\x89\x45\xE4\x8B\x45\xF4"
"\x48\x98\x48\x8D\x55\xB0\x48\x01\xD0\x8B\x55\xF4\x48\x63\xD2\x48"
"\x8D\x4D\xB0\x48\x01\xCA\x0F\xB6\x12\x89\xD1\x8B\x55\xE4\x31\xCA"
"\x88\x10\x83\x45\xF4\x01\x8B\x45\xF4\x3B\x45\xEC\x0F\x8C\x1C\xFF"
"\xFF\xFF\xC7\x45\xFC\x00\x00\x00\x00\xEB\x26\x8B\x45\xFC\x48\x98"
"\x0F\xB6\x54\x05\xB0\x8B\x45\xFC\x48\x98\x0F\xB6\x44\x05\xC0\x38"
"\xC2\x74\x0A\xB8\x00\x00\x00\x00\xE9\xF6\x00\x00\x00\x83\x45\xFC"
"\x01\x83\x7D\xFC\x07\x7E\xD4\xC7\x45\xF8\x00\x00\x00\x00\xC7\x45"
"\xFC\x00\x00\x00\x00\xEB\x4F\x83\x7D\xF8\x04\x75\x07\xC7\x45\xF8"
"\x00\x00\x00\x00\x8B\x45\xFC\x48\x63\xD0\x48\x8B\x85\xA0\xFE\xFF"
"\xFF\x48\x01\xD0\x8B\x55\xFC\x48\x63\xCA\x48\x8B\x95\xA0\xFE\xFF"
"\xFF\x48\x01\xCA\x0F\xB6\x32\x8B\x55\xF8\x48\x63\xCA\x48\x8B\x95"
"\xA8\xFE\xFF\xFF\x48\x01\xCA\x0F\xB6\x12\x31\xF2\x88\x10\x83\x45"
"\xFC\x01\x83\x45\xF8\x01\x81\x7D\xFC\xF2\x01\x00\x00\x7E\xA8\xC7"
"\x45\xFC\x00\x00\x00\x00\xEB\x45\x8B\x45\xFC\x48\x63\xD0\x48\x8B"
"\x85\x98\xFE\xFF\xFF\x48\x01\xD0\x8B\x55\xFC\x48\x63\xCA\x48\x8B"
"\x95\x98\xFE\xFF\xFF\x48\x01\xCA\x0F\xB6\x32\x8B\x55\xFC\x48\x63"
"\xD2\x48\x8D\x8A\xd5\x03\x00\x00\x48\x8B\x95\x98\xFE\xFF\xFF\x48" // \x67\x45 - > \xd5\x03
"\x01\xCA\x0F\xB6\x12\x31\xF2\x88\x10\x83\x45\xFC\x01\x81\x7D\xFC"
"\x08\x01\x00\x00\x7E\xB2\x48\x8B\x85\xA0\xFE\xFF\xFF\x48\x89\x45"//\x33\x12 - >\x08\x01 
"\xD8\x48\x8B\x85\xA8\xFE\xFF\xFF\x48\x8D\x78\x04\x48\x8B\x95\xA0"
"\xFE\xFF\xFF\x48\x8B\x8D\x98\xFE\xFF\xFF\x48\x8B\x45\xD8\x48\x89"
"\xCE\xFF\xD0\xC9\xC3"

//char step4_xor_0x23_xor_step2_tail[] =
"\x23\x23\x23\x23\x23\x21\x23\x63\x6a\xaa\x5e\xb3\xe2\x17\xfe\x0d"
"\x1b\x99\x97\xaa\x96\x83\xdd\x1b\x99\x93\xaa\xb6\xbb\xdd\x1b\x99"
"\x04\x74\xa4\xc3\x17\x45\xe4\xa1\x82\x8a\xcf\xe5\x66\xc5\x6b\x70"
"\x25\xa1\xf6\x4f\x4d\x6f\xf2\xe1\xe0\xef\xbe\xab\xe4\xb6\xe4\x95"
"\x6b\x2b\x46\x84\x55\x99\x2b\xa7\xd0\xdf\xe3\x05\x23\x23\x23\xe3"
"\x53\x95\xdd\x0c\x64\x16\xe3\xe2\xd4\x91\xab\xee\x90\x32\x0e\x5f"
"\xa2\x84\x6b\x99\x2a\x63\xe5\x14\x2e\x9a\xd0\xd4\x28\x96\xe0\xe3"
"\xed\x50\x00\x98\x20\x94\xf3\xaf\x55\x64\x29\x75\x19\xee\x90\x84"
"\x6c\x18\xa6\x8b\xdd\xdc\x37\x59\x67\x23\x23\x22\xa0\x5e\xdf\xcd"
"\x0d\x37\xa1\x9a\x52\x2f\x23\xa8\x66\x18\x2e\xb8\xf3\x6b\xa8\xa6"
"\x60\x9b\x5f\xa1\x93\x24\x86\x2b\x52\x66\x58\xc3\x2c\xaa\xe1\xe0"
"\x05\x1e\xe3\x14\xf6\xdb\x23\x23\x0f\x6a\xe2\x7e\xe0\x77\x54\x2e"
"\xbc\xa1\x08\x78\x3e\x78\xee\x8a\x17\xd3\x6a\x59\xa9\xa6\xd4\xdd"
"\x40\x29\x93\xac\xff\x39\x23\x41\x28\xa4\xc1\x34\xa2\x52\xee\xcf"
"\xa1\xe5\xa2\xde\xa3\x18\x71\xe5\xe5\xa2\xdf\x4b\x5d\x97\x80\xbd"
"\xed\xb6\x97\x23\xa4\x40\x2e\x54\x2e\x63\xe3\x3a\x76\x95\x95\x57"
"\x99\x48\x2e\x56\xf5\x5d\x8e\x16\x1f";
unsigned char step3 [] = 
"\x01\x20\xec\xba\x1c\xeb\x89\x0f\x1c\xe1\x18\x97\x1c\xe1\x10\x9f"
"\x1c\xe1\x30\xe7\x1c\xaf\x20\xbf\x54\x68\x65\x5f\x1c\xe5\x20\xbf"
"\x1c\xe1\x20\xa7\x93\x2d\x91\x5f\x54\x68\x65\x17\xec\x28\x33\x6a"
"\x37\x22\x23\x62\x1b\x20\xec\x1a\x84\x0e\xa2\x1a\x8c\x4d\x65\xb6"
"\xf9\x68\x65\x5f\x1c\xe3\x20\xa7\x1c\xe5\x35\x5e\x1c\xe1\x30\xa7"
"\x1c\xe3\x30\x97\x5b\xde\x77\x9f\xae\x6a\xe6\x9d\x64\xe0\x75\x17"
"\xdf\x2d\x9d\x17\xd9\x38\x64\x17\xdd\x3d\x9d\x17\xdf\x3d\xad\x50"
"\xe2\x7a\x6a\xe1\x86\xa9\x87\x5b\xdd\xb9\xe6\xbe\x64\x20\xee\x0a"
"\x9c\x20\xe6\x9d\x55\x67\xd3\x4d\x94\x92\x61\x5e\x9e\xeb\xa7\x6f"
"\xdc\x78\x2d\xd4\x11\x90\x2d\xd2\x04\x69\x2d\xd6\x01\x90\x2d\xd4"
"\x01\xa0\x2d\xdc\x96\x69\x6a\xe9\x46\x67\xdb\x8d\x95\x8a\x67\xd6"
"\x85\xeb\x84\x63\x1c\xe3\x30\x97\x1c\xeb\xa7\x5d\x5b\xde\x77\x9f"
"\xae\x6e\x64\x95\xd7\xaa\x55\xd7\x44\x20\xee\x1a\xac\x20\xe8\x0f"
"\x55\x20\xec\x0a\xac\x20\xee\x0a\x9c\x20\xe6\x9d\x56\x67\xd3\x4d"
"\xd7\x8a\x5a\xdc\x96\x58\xed\x4f\x1c\xeb\x20\x97\x57\xeb\x20\xab"
"\x55\xeb\x18\xab\x55\x67\xeb\x16\xab\x97\x9a\x98\x11\x9c\x65\x5f"
"\x54\x68\x8e\x7c\xdf\x2d\x91\x17\xcc\x67\xd3\x0b\x51\x88\xee\x1a"
"\xa0\x20\xfd\x50\xe2\x2c\x60\x8f\x6c\xaa\x11\x58\xec\x68\x65\x5f"
"\x54\x83\x00\xdc\x11\x9c\x64\xdc\x29\x9c\x62\x21\x83\x20\xee\x1a"
"\x94\x20\xec\x1a\xbc\xaf\x20\xab\x54\x68\x65\x5f\xbf\x4e\xee\x1a"
"\xa0\x20\x06\x8f\x1c\xe3\x20\x9f\x1c\x69\xb5\xd4\x01\x9c\x2d\x3c"
"\x9e\x20\xee\x0a\x94\x20\x64\x95\x5b\xde\x77\xdc\xa6\x4b\xed\x4f"
"\xd7\x2d\x91\x5e\xd5\x15\x91\x57\x55\x68\x65\x21\x85\x20\xee\x1a"
"\xec\x20\xe8\xd7\xde\x69\x65\x5f\x1c\xe3\x30\x97\x1c\xe3\x20\xb7"
"\x1c\xe1\xab\x17\xdd\xbf\x9a\x8f\x9d\xab\x00\x71\x82\xdf\x68\x89"
"\x19\xe6\xfd\x48\xe1\x07\x65\x09\x3b\xfc\x65\xf4\x64\x46\xb1\x48"
"\xf9\x38\xe3\x29\x04\x8c\x65\xf0\x5c\xcc\x4f\x4d\x59\xbc\x10\xd1"
"\x43\xb9\xe0\x01\x6b\xb8\x2a\x02\xa7\x72\xa4\x01\xc9\x4f\x0d\x48"
"\xef\x4b\xd2\x45\x92\xf7\x57\x36\xbd\x2a\x2f\xb6\x21\xfc\x02\xcf"
"\x64\x2d\x1d\xb2\x4e\xd2\x68\x83\xa4\x0d\x35\xbb\x01\x38\xe3\x7c"
"\xf8\x02\xe2\x75\x63\xb6\x3b\x0d\x11\x37\xbe\x3c\xb3\x3a\x20\x00"
"\x64\x53\xf9";
int main()
{
    char input[100] = {0}; 
    int (*Check )(char*, char *, char *);
    Check = (int(*)(char *,char *, char *))step2;
    int result = 0;
    
    scanf("%s",input);
    printf("Step2: %s \n",input);
    result = Check(input,step3,step2);

    if(result == 0)
    {
        printf("NO\n");
    }
    else if(result == 1)
    {
        printf("OK\n");
    }
    else
    {
        printf("error!!!\n");
    }
    printf("===end===");
    return 0;
}
int Check_The_(char * input, char * step3, char * self)
{
    unsigned char rc4_key[4];
    int keylength = 4;  //key len
    int EncryptLen = 8;   //input len
    const unsigned char cmp[] = "\x5d\x09\x90\x90\x26\x2f\x01\x8a";
    unsigned char Encrypt[8];

    int i,j,k,temp,n;
    unsigned char SBox[256];

    int (*step3__ )(char*, char *, char *);
    //
    rc4_key[0] = input[0];
    rc4_key[1] = input[1];
    rc4_key[2] = input[2];
    rc4_key[3] = input[3];
    //
    input = input+5;
    //
    for(i = 0 ; i < 4; i++)
    {
        Encrypt[2*i] = input[i] & 0xf;
        Encrypt[2*i+1] = input[i] >> 4;
    }

    //rc4
    for (i = 0; i < 256; i++)
    {
	    SBox[i] = i;
    }
        
    for (j = 0, i = 0; i < 256; i++)
    {
        j = (j + SBox[i] + *(rc4_key + i % keylength)) % 256;

        temp = SBox[i];
        SBox[i] = SBox[j];
        SBox[j] = temp;
    }
    i = 0; j = 0;
    for(k = 0; k < EncryptLen; k ++)
    {
         i = (i + 1) % 256;
        j = (j + SBox[i]) % 256;
        
        temp = SBox[i];
        SBox[i] = SBox[j];
        SBox[j] = temp;

        n = SBox[(SBox[i] + SBox[j]) % 256];
        
        *(Encrypt + k) = *(Encrypt + k) ^ n;
         
         
    }

    //
    for(i = 0; i < 8; i ++)
    {
        if(Encrypt[i] != cmp[i])
        {
            return 0;
        }
    }
    //decrypt for step3
    
    for(j = 0,i = 0; i < 499 ; i ++, j ++)
    {
        if(j == 4)
        {
            j = 0;
        }
        step3[i] = step3[i] ^ input[j];
    }
    
    //decrypt itself
    
    for(i = 0; i < 0x1234; i ++)
    {
        self[i] = self[i] ^ self[i+0x4567];
    }
    
    step3__ =  (int(*)(char *,char *, char *))step3;
    return step3__(input+4,self,step3);
}
/*
unsigned char step3[] =
"\x55\x48\x89\xE5\x48\x83\xEC\x50\x48\x89\x7D\xC8\x48\x89\x75\xC0"
"\x48\x89\x55\xB8\x48\xC7\x45\xE0\x00\x00\x00\x00\x48\x8D\x45\xE0"
"\x48\x89\x45\xF8\xC7\x45\xF4\x00\x00\x00\x00\x48\xB8\x40\x56\x35"
"\x63\x4A\x46\x3D\x4F\x48\x89\x45\xD0\x66\xC7\x45\xD8\x25\x00\xE9"
"\xAD\x00\x00\x00\x48\x8B\x45\xF8\x48\x8D\x50\x01\x48\x89\x55\xF8"
"\x48\x8B\x55\xC8\x0F\xB6\x12\xC0\xFA\x02\x83\xC2\x30\x88\x10\x48"
"\x8B\x45\xF8\x48\x8D\x50\x01\x48\x89\x55\xF8\x48\x8B\x55\xC8\x0F"
"\xB6\x12\x0F\xBE\xD2\xC1\xE2\x04\x89\xD1\x83\xE1\x30\x48\x8B\x55"
"\xC8\x48\x83\xC2\x01\x0F\xB6\x12\xC0\xFA\x04\x01\xCA\x83\xC2\x30"
"\x88\x10\x48\x8B\x45\xF8\x48\x8D\x50\x01\x48\x89\x55\xF8\x48\x8B"
"\x55\xC8\x48\x83\xC2\x01\x0F\xB6\x12\x0F\xBE\xD2\xC1\xE2\x02\x89"
"\xD1\x83\xE1\x3C\x48\x8B\x55\xC8\x48\x83\xC2\x02\x0F\xB6\x12\xC0"
"\xFA\x06\x01\xCA\x83\xC2\x30\x88\x10\x48\x8B\x45\xF8\x48\x8D\x50"
"\x01\x48\x89\x55\xF8\x48\x8B\x55\xC8\x48\x83\xC2\x02\x0F\xB6\x12"
"\x83\xE2\x3F\x83\xC2\x30\x88\x10\x48\x83\x45\xC8\x03\x83\x45\xF4"
"\x01\x83\x7D\xF4\x01\x0F\x8E\x49\xFF\xFF\xFF\xC7\x45\xF4\x00\x00"
"\x00\x00\xEB\x23\x8B\x45\xF4\x48\x98\x0F\xB6\x54\x05\xE0\x8B\x45"
"\xF4\x48\x98\x0F\xB6\x44\x05\xD0\x38\xC2\x74\x07\xB8\x00\x00\x00"
"\x00\xEB\x65\x83\x45\xF4\x01\x83\x7D\xF4\x07\x7E\xD7\x48\x8B\x45"
"\xC0\x48\x89\x45\xE8\xC7\x45\xF4\x00\x00\x00\x00\xEB\x26\x8B\x45"
"\xF4\x48\x63\xD0\x48\x8B\x45\xC0\x48\x01\xD0\x8B\x55\xF4\x48\x63"
"\xCA\x48\x8B\x55\xC0\x48\x01\xCA\x0F\xB6\x12\x83\xF2\x23\x88\x10"
"\x83\x45\xF4\x01\x81\x7D\xF4\x08\x01\x00\x00\x7E\xD1\x48\x8B\x45"
"\xB8\x48\x8D\x88\x8a\x01\x00\x00\x48\x8B\x55\xC8\x48\x8B\x45\xE8"
"\x48\x89\xCE\x48\x89\xD7\xFF\xD0\xC9\xC3"
//char step5_after[] = 
"\x65\x2e\xd6\xb7\x0d\xd6\x4d\x8e\x98\x17\xb5\x6f\x00\x56\x6f\x94"
"\x00\xab\x30\x2e\xd4\x17\xad\x50\x86\x76\x50\xe4\x00\xaf\x08\xa4"
"\x2a\x12\x0d\xd4\x75\x8e\x17\xd1\x85\x5e\x3f\xd0\x4f\x5d\xf3\x1a"
"\xc1\x5e\x9d\x27\x68\x17\xbb\x23\xb7\x1a\xc6\x9f\x32\x69\xe9\x42"
"\x4a\xe9\x75\x94\x67\x90\x30\x45\x78\xed\x1a\xba\x0d\xdc\xf0\x65"
"\x50\xe4\x55\x50\x86\x23\xac\x6a\x87\x2a\x37\xde\x5e\x52\x45\x5f"
"\xdb\x63\xe7\x52\x45\x5f\x30\x3b\x9c";
*/