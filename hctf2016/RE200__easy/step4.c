#include <stdio.h>
int Check_0f_RE_1(char *input, char * step5_Bin);

char step5_after[] = 
"\x65\x2e\xd6\xb7\x0d\xd6\x4d\x8e\x98\x17\xb5\x6f\x00\x56\x6f\x94"
"\x00\xab\x30\x2e\xd4\x17\xad\x50\x86\x76\x50\xe4\x00\xaf\x08\xa4"
"\x2a\x12\x0d\xd4\x75\x8e\x17\xd1\x85\x5e\x3f\xd0\x4f\x5d\xf3\x1a"
"\xc1\x5e\x9d\x27\x68\x17\xbb\x23\xb7\x1a\xc6\x9f\x32\x69\xe9\x42"
"\x4a\xe9\x75\x94\x67\x90\x30\x45\x78\xed\x1a\xba\x0d\xdc\xf0\x65"
"\x50\xe4\x55\x50\x86\x23\xac\x6a\x87\x2a\x37\xde\x5e\x52\x45\x5f"
"\xdb\x63\xe7\x52\x45\x5f\x30\x3b\x9c";
char step4[] =
"\x55\x48\x89\xE5\x48\x83\xEC\x30\x48\x89\x7D\xD8\x48\x89\x75\xD0"
"\xC7\x45\xFC\x00\x00\x00\x00\xC7\x45\xF8\x00\x00\x00\x00\xC7\x45"
"\xE0\x12\x77\xE4\x34\x66\xC7\x45\xE4\x45\xE4\xC6\x45\xE6\x00\xEB"
"\x5B\x8B\x45\xFC\x48\x63\xD0\x48\x8B\x45\xD8\x48\x01\xD0\x0F\xB6"
"\x00\x83\xE0\x0F\x88\x45\xF7\x8B\x45\xFC\x48\x63\xD0\x48\x8B\x45"
"\xD8\x48\x01\xD0\x0F\xB6\x00\xC0\xF8\x04\x88\x45\xF6\xC0\x65\xF7"
"\x04\x0F\xB6\x45\xF6\x08\x45\xF7\x0F\xB6\x45\xF7\x83\xF0\x11\x88"
"\x45\xF6\x8B\x45\xFC\x48\x98\x0F\xB6\x44\x05\xE0\x3A\x45\xF6\x74"
"\x07\xB8\x00\x00\x00\x00\xEB\x7F\x83\x45\xFC\x01\x83\x7D\xFC\x05"
"\x7E\x9F\xC7\x45\xFC\x00\x00\x00\x00\xC7\x45\xF8\x00\x00\x00\x00"
"\xEB\x46\x83\x7D\xF8\x06\x75\x07\xC7\x45\xF8\x00\x00\x00\x00\x8B"
"\x45\xFC\x48\x63\xD0\x48\x8B\x45\xD0\x48\x01\xD0\x8B\x55\xFC\x48"
"\x63\xCA\x48\x8B\x55\xD0\x48\x01\xCA\x0F\xB6\x32\x8B\x55\xF8\x48"
"\x63\xCA\x48\x8B\x55\xD8\x48\x01\xCA\x0F\xB6\x12\x31\xF2\x88\x10"
"\x83\x45\xFC\x01\x83\x45\xF8\x01\x83\x7D\xFC\x68\x7E\xB4\x48\x8B"
"\x45\xD0\x48\x89\x45\xE8\x48\x8B\x45\xD8\x48\x8D\x50\x06\x48\x8B"
"\x45\xE8\x48\x89\xD7\xFF\xD0\xC9\xC3";
int main()
{
    char input[100]; 
    int (*Check_0f_RE_ )(char*, char *);
    Check_0f_RE_ = (int(*)(char *,char *))step4;
    int result = 0;
    
    scanf("%s",input);
    printf("Step4: %s \n",input);
    result = Check_0f_RE_(input,step5_after);

    if(result == 0)
    {
        printf("NO\n");
    }
    else if(result == 1)
    {
        printf("OK\n");
    }
    else
    {
        printf("error!!!\n");
    }
    printf("===end===");
    return 0;
}

int Check_0f_RE_1(char *input, char * step5_Bin)
{
    int i =0; int j = 0;
    unsigned char a,b;
    int (*Check_Last_Mutiple_Flag)(char* );
    unsigned char Check_this[] = "\x12\x77\xE4\x34\x45\xE4";
    //check input is right
    for(; i < 6; i ++)
    {
        a = input[i] & 0xF;
        b = input[i] >> 4;
        a = a << 4;
        a = a|b;
        b = a^0x11;
        if(b != Check_this[i])
        {
            return 0;
        }
    }
    //decode
    i = 0;j = 0;
    for(;i<105; i++,j++)
    {
        if(j == 6)
        {
            j = 0;
        }
        step5_Bin[i] = step5_Bin[i] ^ input[j];
    }
    Check_Last_Mutiple_Flag = (int(*)(char *))step5_Bin;
    //run it
    return Check_Last_Mutiple_Flag(input+6);
}

/*
#include <stdio.h>
#include <string.h>
unsigned char step5[] = 
"\x55\x48\x89\xE5\x48\x89\x7D\xE8\xC7\x45\xF0\x30\x30\x30\x30\xC6"
"\x45\xF4\x00\x48\x8B\x45\xE8\x0F\xB6\x10\x0F\xB6\x45\xF0\x38\xC2"
"\x75\x40\x48\x8B\x45\xE8\x48\x83\xC0\x01\x0F\xB6\x10\x0F\xB6\x45"
"\xF1\x38\xC2\x75\x2D\x48\x8B\x45\xE8\x48\x83\xC0\x02\x0F\xB6\x10"
"\x0F\xB6\x45\xF2\x38\xC2\x75\x1A\x48\x8B\x45\xE8\x48\x83\xC0\x03"
"\x0F\xB6\x10\x0F\xB6\x45\xF3\x38\xC2\x75\x07\xB8\x01\x00\x00\x00"
"\xEB\x05\xB8\x00\x00\x00\x00\x5D\xC3";
unsigned char step5_after[] = 
"\x65\x2e\xd6\xb7\x0d\xd6\x4d\x8e\x98\x17\xb5\x6f\x00\x56\x6f\x94"
"\x00\xab\x30\x2e\xd4\x17\xad\x50\x86\x76\x50\xe4\x00\xaf\x08\xa4"
"\x2a\x12\x0d\xd4\x75\x8e\x17\xd1\x85\x5e\x3f\xd0\x4f\x5d\xf3\x1a"
"\xc1\x5e\x9d\x27\x68\x17\xbb\x23\xb7\x1a\xc6\x9f\x32\x69\xe9\x42"
"\x4a\xe9\x75\x94\x67\x90\x30\x45\x78\xed\x1a\xba\x0d\xdc\xf0\x65"
"\x50\xe4\x55\x50\x86\x23\xac\x6a\x87\x2a\x37\xde\x5e\x52\x45\x5f"
"\xdb\x63\xe7\x52\x45\x5f\x30\x3b\x9c";
int main()
{
    int i = 0; int j = 0;
    char input[] = "0f_RE_";
    for(;i<105; i++,j++)
    {
        if(j == 6)
        {
            j = 0;
        }
        step5[i] = step5[i] ^ input[j];
    }
    i = 0;
    for(;i<105; i++)
    {
        if(i%16 == 0) printf("\n");
        printf("\\x%x",step5[i]);
    }
    return 0;
}
*/